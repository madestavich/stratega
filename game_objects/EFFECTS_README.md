# –°–∏—Å—Ç–µ–º–∞ –µ—Ñ–µ–∫—Ç—ñ–≤ (Effect System)

## –û–≥–ª—è–¥

–°–∏—Å—Ç–µ–º–∞ –µ—Ñ–µ–∫—Ç—ñ–≤ –¥–æ–∑–≤–æ–ª—è—î –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ –∞–Ω—ñ–º–æ–≤–∞–Ω—ñ –≤—ñ–∑—É–∞–ª—å–Ω—ñ –µ—Ñ–µ–∫—Ç–∏ –≤ –≥—Ä—ñ –∑ –≥–Ω—É—á–∫–∏–º –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è–º —Ç–∞ —à–∞—Ä—É–≤–∞–Ω–Ω—è–º (z-index).

## –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- ‚úÖ –ü—Ä–∏–≤'—è–∑–∫–∞ –¥–æ —é–Ω—ñ—Ç—ñ–≤ –∞–±–æ –∞–±—Å–æ–ª—é—Ç–Ω–µ –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü—ñ—è –¥–æ –∞–Ω—ñ–º–æ–≤–∞–Ω–∏—Ö –∫–∞–¥—Ä—ñ–≤ —Ä—ñ–∑–Ω–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É
- ‚úÖ –¢—Ä–∏ —Ä–µ–∂–∏–º–∏ z-index: –ø—ñ–¥ —é–Ω—ñ—Ç–æ–º, –Ω–∞–¥ —é–Ω—ñ—Ç–æ–º, —Ç–æ–ø-—Ä—ñ–≤–µ–Ω—å —Å—Ü–µ–Ω–∏
- ‚úÖ –¢—Ä–∏ —Ç–æ—á–∫–∏ –ø—Ä–∏–≤'—è–∑–∫–∏: —Ü–µ–Ω—Ç—Ä, –Ω–∏–∑, –≤–µ—Ä—Ö —Å–ø—Ä–∞–π—Ç–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ—ó
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ loop-–∞–Ω—ñ–º–∞—Ü—ñ–π
- ‚úÖ Debug —Ä–µ–∂–∏–º –¥–ª—è –≤—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è

## –ö–ª–∞—Å–∏

### Effect

–û—Å–Ω–æ–≤–Ω–∏–π –∫–ª–∞—Å –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –µ—Ñ–µ–∫—Ç—É.

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞:**

```javascript
{
  // –ü—Ä–∏–≤'—è–∑–∫–∞ –¥–æ —é–Ω—ñ—Ç–∞ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
  targetUnit: GameObject | null,

  // –¢–æ—á–∫–∞ –ø—Ä–∏–≤'—è–∑–∫–∏ –Ω–∞ —Å–ø—Ä–∞–π—Ç—ñ —é–Ω—ñ—Ç–∞
  attachmentPoint: 'center' | 'bottom' | 'top',

  // –ê–±—Å–æ–ª—é—Ç–Ω–∞ –ø–æ–∑–∏—Ü—ñ—è (—è–∫—â–æ –Ω–µ–º–∞—î targetUnit)
  x: number,
  y: number,
  z: number,

  // Z-layer —Å—Ç—Ä–∞—Ç–µ–≥—ñ—è
  zMode: 'under' | 'over' | 'top',
  zOffset: number, // –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –æ—Ñ—Å–µ—Ç –¥–ª—è fine-tuning

  // Offset –≤—ñ–¥ —Ç–æ—á–∫–∏ –ø—Ä–∏–≤'—è–∑–∫–∏
  offsetX: number,
  offsetY: number,

  // Lifecycle
  duration: number | null, // null = –≥—Ä–∞—î –ø–æ–∫–∏ –Ω–µ –∑–∞–∫—ñ–Ω—á–∏—Ç—å—Å—è –∞–Ω—ñ–º–∞—Ü—ñ—è
  autoRemove: boolean,     // –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
  loop: boolean            // —Ü–∏–∫–ª—ñ—á–Ω–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è
}
```

### EffectManager

–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤—Å—ñ–º–∞ –µ—Ñ–µ–∫—Ç–∞–º–∏.

## –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 1. –ï—Ñ–µ–∫—Ç –ø–æ–ø–∞–¥–∞–Ω–Ω—è –ø–æ —é–Ω—ñ—Ç—É

```javascript
// –í attackAction.js –ø—Ä–∏ dealDamage
dealDamage(attacker, target, damageMultiplier = 1) {
  // ... —ñ—Å–Ω—É—é—á–∏–π –∫–æ–¥ –Ω–∞–Ω–µ—Å–µ–Ω–Ω—è —à–∫–æ–¥–∏ ...

  // –°—Ç–≤–æ—Ä—é—î–º–æ –µ—Ñ–µ–∫—Ç –ø–æ–ø–∞–¥–∞–Ω–Ω—è –Ω–∞ —Ü—ñ–ª—ñ
  if (this.objectManager.effectManager) {
    const hitEffectConfig = {
      "hit_effect": {
        "imagePath": "sprites/effects/hit.png",
        "animations": {
          "hit": {
            "frames": [/* –∫–∞–¥—Ä–∏ –∞–Ω—ñ–º–∞—Ü—ñ—ó */]
          }
        }
      }
    };

    this.objectManager.effectManager.createEffectOnUnit(
      target,
      hitEffectConfig,
      {
        attachmentPoint: 'center',
        zMode: 'over',
        autoRemove: true,
        loop: false
      }
    );
  }
}
```

### 2. –ï—Ñ–µ–∫—Ç –ø–æ—á–∞—Ç–∫—É –∞—Ç–∞–∫–∏

```javascript
// –í attackAction.js –ø—Ä–∏ execute() - –ø–æ—á–∞—Ç–æ–∫ –∞—Ç–∞–∫–∏
execute(gameObject) {
  if (!gameObject.isAttacking && gameObject.attackTarget) {
    gameObject.isAttacking = true;

    // –°—Ç–≤–æ—Ä—é—î–º–æ –µ—Ñ–µ–∫—Ç —Å–≤—ñ—á–µ–Ω–Ω—è –Ω–∞–≤–∫–æ–ª–æ –∞—Ç–∞–∫—É—é—á–æ–≥–æ
    if (this.objectManager.effectManager) {
      const attackGlowConfig = { /* –∫–æ–Ω—Ñ—ñ–≥ —Å–ø—Ä–∞–π—Ç—É */ };

      this.objectManager.effectManager.createEffectOnUnit(
        gameObject,
        attackGlowConfig,
        {
          attachmentPoint: 'center',
          zMode: 'under', // –ø—ñ–¥ —é–Ω—ñ—Ç–æ–º
          autoRemove: true,
          loop: false
        }
      );
    }

    // ... —Ä–µ—à—Ç–∞ –∫–æ–¥—É ...
  }
}
```

### 3. –ï—Ñ–µ–∫—Ç area attack —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞

```javascript
// –ü–æ–∫–∞–∑—É—î–º–æ –∑–æ–Ω—É –¥—ñ—ó area attack
if (gameObject.areaAttack && window.gameManager.debugMode) {
  const areaIndicatorConfig = {
    /* –∫–æ–Ω—Ñ—ñ–≥ */
  };

  this.objectManager.effectManager.createEffectOnUnit(
    gameObject.attackTarget,
    areaIndicatorConfig,
    {
      attachmentPoint: "bottom",
      zMode: "under",
      autoRemove: true,
      loop: true,
      duration: 2000, // 2 —Å–µ–∫—É–Ω–¥–∏
    }
  );
}
```

### 4. –ï—Ñ–µ–∫—Ç –Ω–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ñ–π –ø–æ–∑–∏—Ü—ñ—ó

```javascript
// –ï—Ñ–µ–∫—Ç –≤–∏–±—É—Ö—É –≤ —Ç–æ—á—Ü—ñ –Ω–∞ –∫–∞—Ä—Ç—ñ
const explosionConfig = {
  /* –∫–æ–Ω—Ñ—ñ–≥ */
};

this.objectManager.effectManager.createEffectAtPosition(
  500, // x
  300, // y
  explosionConfig,
  {
    zMode: "top", // –ø–æ–≤–µ—Ä—Ö –≤—Å—å–æ–≥–æ
    autoRemove: true,
    loop: false,
  }
);
```

### 5. –ü–æ—Å—Ç—ñ–π–Ω–∏–π loop-–µ—Ñ–µ–∫—Ç

```javascript
// –ê—É—Ä–∞ –Ω–∞–≤–∫–æ–ª–æ —é–Ω—ñ—Ç–∞ (–ø–æ—Å—Ç—ñ–π–Ω–æ)
const auraConfig = {
  /* –∫–æ–Ω—Ñ—ñ–≥ */
};

this.objectManager.effectManager.createEffectOnUnit(unit, auraConfig, {
  attachmentPoint: "bottom",
  zMode: "under",
  autoRemove: false, // –ù–ï –≤–∏–¥–∞–ª—è—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
  loop: true, // —Ü–∏–∫–ª—ñ—á–Ω–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è
});

// –í–∏–¥–∞–ª–∏—Ç–∏ –≤—Ä—É—á–Ω—É –∫–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ:
this.objectManager.effectManager.removeEffectsForUnit(unit);
```

## Z-index —Ä–µ–∂–∏–º–∏

### `under` - –ø—ñ–¥ —é–Ω—ñ—Ç–æ–º

```javascript
zMode: "under";
// z = targetUnit.z - 1
// –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥–ª—è: —Ç—ñ–Ω—ñ, –º–∞–≥—ñ—á–Ω–∏—Ö –∫—ñ–ª –ø—ñ–¥ –Ω–æ–≥–∞–º–∏, —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä—ñ–≤ –Ω–∞ –∑–µ–º–ª—ñ
```

### `over` - –Ω–∞–¥ —é–Ω—ñ—Ç–æ–º

```javascript
zMode: "over";
// z = targetUnit.z + 1
// –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥–ª—è: –µ—Ñ–µ–∫—Ç—ñ–≤ –ø–æ–ø–∞–¥–∞–Ω–Ω—è, —Å–ø–∞–ª–∞—Ö—ñ–≤, —ñ—Å–∫—Ä
```

### `top` - —Ç–æ–ø-—Ä—ñ–≤–µ–Ω—å —Å—Ü–µ–Ω–∏

```javascript
zMode: "top";
// z = 999999
// –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥–ª—è: UI-–µ—Ñ–µ–∫—Ç—ñ–≤, –≤–∞–∂–ª–∏–≤–∏—Ö —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä—ñ–≤ –ø–æ–≤–µ—Ä—Ö –≤—Å—å–æ–≥–æ
```

## –¢–æ—á–∫–∏ –ø—Ä–∏–≤'—è–∑–∫–∏

### `center` - —Ü–µ–Ω—Ç—Ä —Å–ø—Ä–∞–π—Ç–∞

```javascript
attachmentPoint: "center";
// –ü–æ–∑–∏—Ü—ñ—è = unit.x, unit.y (—Ü–µ–Ω—Ç—Ä —é–Ω—ñ—Ç–∞)
```

### `bottom` - –Ω–∏–∑ —Å–ø—Ä–∞–π—Ç–∞

```javascript
attachmentPoint: "bottom";
// –ü–æ–∑–∏—Ü—ñ—è = –Ω–∏–∑ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–∞–¥—Ä—É —é–Ω—ñ—Ç–∞
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∞–¥–∞–ø—Ç—É—î—Ç—å—Å—è –¥–æ —Ä—ñ–∑–Ω–∏—Ö —Ä–æ–∑–º—ñ—Ä—ñ–≤ –∫–∞–¥—Ä—ñ–≤
```

### `top` - –≤–µ—Ä—Ö —Å–ø—Ä–∞–π—Ç–∞

```javascript
attachmentPoint: "top";
// –ü–æ–∑–∏—Ü—ñ—è = –≤–µ—Ä—Ö –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–∞–¥—Ä—É —é–Ω—ñ—Ç–∞
```

## Fine-tuning –ø–æ–∑–∏—Ü—ñ—ó

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Å—É–Ω—É—Ç–∏ –µ—Ñ–µ–∫—Ç –≤—ñ–¥–Ω–æ—Å–Ω–æ —Ç–æ—á–∫–∏ –ø—Ä–∏–≤'—è–∑–∫–∏:

```javascript
this.objectManager.effectManager.createEffectOnUnit(target, effectConfig, {
  attachmentPoint: "center",
  offsetX: 20, // –∑—Å—É–≤ –Ω–∞ 20 –ø—ñ–∫—Å–µ–ª—ñ–≤ –≤–ø—Ä–∞–≤–æ
  offsetY: -10, // –∑—Å—É–≤ –Ω–∞ 10 –ø—ñ–∫—Å–µ–ª—ñ–≤ –≤–≥–æ—Ä—É
  zOffset: 0.5, // —Ç–æ–Ω–∫–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è z-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏
});
```

## Debug —Ä–µ–∂–∏–º

–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å `` ` `` (backtick) –¥–ª—è —É–≤—ñ–º–∫–Ω–µ–Ω–Ω—è debug-—Ä–µ–∂–∏–º—É.

–í debug —Ä–µ–∂–∏–º—ñ –µ—Ñ–µ–∫—Ç–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å:

- üü£ –§—ñ–æ–ª–µ—Ç–æ–≤–∞ —Ä–∞–º–∫–∞ –Ω–∞–≤–∫–æ–ª–æ –µ—Ñ–µ–∫—Ç—É
- üü° –ñ–æ–≤—Ç–∞ —Ç–æ—á–∫–∞ –≤ —Ü–µ–Ω—Ç—Ä—ñ –µ—Ñ–µ–∫—Ç—É
- üìè –ü—É–Ω–∫—Ç–∏—Ä–Ω–∞ –ª—ñ–Ω—ñ—è –¥–æ target —é–Ω—ñ—Ç–∞ (—è–∫—â–æ –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π)
- üìä –¢–µ–∫—Å—Ç –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ z-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—É —Ç–∞ —Ä–µ–∂–∏–º

## –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –≤ —é–Ω—ñ—Ç–∏

–î–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –µ—Ñ–µ–∫—Ç—ñ–≤ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —é–Ω—ñ—Ç—ñ–≤, –¥–æ–¥–∞–π—Ç–µ –≤ —ó—Ö –∫–æ–Ω—Ñ—ñ–≥:

```json
{
  "objectType": "archer",
  "effects": {
    "onAttackStart": "attack_glow_effect",
    "onHit": "arrow_hit_effect",
    "onDeath": "death_explosion_effect",
    "aura": "archer_aura_effect"
  }
}
```

–ü–æ—Ç—ñ–º –≤ –∫–æ–¥—ñ:

```javascript
// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –µ—Ñ–µ–∫—Ç
const effectConfig = await loadEffectConfig(unit.effects.onAttackStart);

// –°—Ç–≤–æ—Ä—é—î–º–æ
this.objectManager.effectManager.createEffectOnUnit(unit, effectConfig, {
  /* options */
});
```

## –ú–µ—Ç–æ–¥–∏ EffectManager

```javascript
// –°—Ç–≤–æ—Ä–∏—Ç–∏ –µ—Ñ–µ–∫—Ç –Ω–∞ —é–Ω—ñ—Ç—ñ
createEffectOnUnit(targetUnit, spriteConfig, options);

// –°—Ç–≤–æ—Ä–∏—Ç–∏ –µ—Ñ–µ–∫—Ç –Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó
createEffectAtPosition(x, y, spriteConfig, options);

// –û–Ω–æ–≤–∏—Ç–∏ –≤—Å—ñ –µ—Ñ–µ–∫—Ç–∏ (–≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
updateAll(deltaTime);

// –†–µ–Ω–¥–µ—Ä–∏—Ç–∏ –≤—Å—ñ –µ—Ñ–µ–∫—Ç–∏ (–≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
renderAll();

// –í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ –µ—Ñ–µ–∫—Ç–∏
clearAll();

// –í–∏–¥–∞–ª–∏—Ç–∏ –µ—Ñ–µ–∫—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —é–Ω—ñ—Ç–∞
removeEffectsForUnit(unit);

// –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ –µ—Ñ–µ–∫—Ç–∏
getAllEffects();
```

## –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å

- –ï—Ñ–µ–∫—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ—ó (—è–∫—â–æ `autoRemove: true`)
- –ï—Ñ–µ–∫—Ç–∏ –ø—Ä–∏–≤'—è–∑–∞–Ω—ñ –¥–æ –º–µ—Ä—Ç–≤–∏—Ö —é–Ω—ñ—Ç—ñ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è
- –í—Å—ñ –µ—Ñ–µ–∫—Ç–∏ —Å–æ—Ä—Ç—É—é—Ç—å—Å—è —Ä–∞–∑–æ–º –∑ —é–Ω—ñ—Ç–∞–º–∏ –∑–∞ z-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—é (–æ–¥–∏–Ω —Ä–∞–∑ –∑–∞ frame)
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ñ—Å–Ω—É—é—á—ñ Animator —Ç–∞ Renderer –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

## Troubleshooting

**–ï—Ñ–µ–∫—Ç –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è:**

- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —à–ª—è—Ö –¥–æ —Å–ø—Ä–∞–π—Ç—É
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –µ—Ñ–µ–∫—Ç –Ω–µ –∑–∞ –º–µ–∂–∞–º–∏ –µ–∫—Ä–∞–Ω—É
- –£–≤—ñ–º–∫–Ω—ñ—Ç—å debug —Ä–µ–∂–∏–º (`` ` ``) –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**–ï—Ñ–µ–∫—Ç –Ω–µ —Å–ª—ñ–¥—É—î –∑–∞ —é–Ω—ñ—Ç–æ–º:**

- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ `targetUnit` –ø–µ—Ä–µ–¥–∞–Ω–æ –∫–æ—Ä–µ–∫—Ç–Ω–æ
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ —é–Ω—ñ—Ç –Ω–µ –º–µ—Ä—Ç–≤–∏–π (–º–µ—Ä—Ç–≤—ñ —é–Ω—ñ—Ç–∏ –≤–∏–¥–∞–ª—è—é—Ç—å —Å–≤–æ—ó –µ—Ñ–µ–∫—Ç–∏)

**–ï—Ñ–µ–∫—Ç –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –Ω–µ –Ω–∞ —Ç–æ–º—É z-—Ä—ñ–≤–Ω—ñ:**

- –°–ø—Ä–æ–±—É–π—Ç–µ —Ä—ñ–∑–Ω—ñ `zMode` ('under', 'over', 'top')
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `zOffset` –¥–ª—è fine-tuning

**–ï—Ñ–µ–∫—Ç –Ω–µ –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è:**

- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ `autoRemove: true`
- –î–ª—è loop-–∞–Ω—ñ–º–∞—Ü—ñ–π –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å `duration` –∞–±–æ –≤–∏–∫–ª–∏–∫–∞–π—Ç–µ `removeEffectsForUnit()` –≤—Ä—É—á–Ω—É
