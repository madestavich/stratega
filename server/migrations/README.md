# Database Migrations

## Battle State Migration

Ця міграція додає поля для відстеження стану бою та запобігання проблемам при оновленні сторінки під час бою.

### Як застосувати міграцію:

1. Відкрийте phpMyAdmin або ваш MySQL клієнт
2. Виберіть вашу базу даних (яка використовується в `server/auth/config.php`)
3. Виконайте SQL з файлу `add_battle_state.sql`

Або через командний рядок:

```bash
mysql -u your_username -p your_database < add_battle_state.sql
```

### Додані поля:

- `battle_started` - чи розпочався бій
- `player1_in_battle` - чи гравець 1 зараз в бою
- `player2_in_battle` - чи гравець 2 зараз в бою

**Примітка:** Використовується існуюче поле `winner_id` для зберігання переможця останнього раунду.

### Що це вирішує:

✅ Попереджає про оновлення сторінки під час бою
✅ Якщо гравець все одно оновив - він чекає завершення бою іншим гравцем
✅ Після завершення бою показується результат і гра продовжується
✅ Синхронізація таймерів між гравцями
✅ Запобігання розсинхрону раундів
