# –û–Ω–æ–≤–ª–µ–Ω–Ω—è: –°–∏—Å—Ç–µ–º–∞ –õ–æ–±–±—ñ –¥–ª—è Stratega

## üìã –©–æ –¥–æ–¥–∞–Ω–æ

### 1. –ü—Ä–æ–º—ñ–∂–Ω–µ –ª–æ–±–±—ñ (`lobby/`)

- **lobby.html** - —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ª–æ–±–±—ñ –∑ –ø–∞–Ω–µ–ª—è–º–∏ –≥—Ä–∞–≤—Ü—ñ–≤, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Ç–∞ –≤–∏–±–æ—Ä—É —Ä–∞—Å
- **lobby.css** - —Å—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –ª–æ–±–±—ñ
- **lobby.js** - –ª–æ–≥—ñ–∫–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ª–æ–±–±—ñ, —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –º—ñ–∂ –≥—Ä–∞–≤—Ü—è–º–∏

### 2. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó —á–∞—Å—Ç–∏–Ω–∏

- **room.php** - –¥–æ–¥–∞–Ω–æ –Ω–æ–≤—ñ endpoints:
  - `update_room_settings` - –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å (—Ç—ñ–ª—å–∫–∏ —Ö–æ—Å—Ç)
  - `select_race` - –≤–∏–±—ñ—Ä —Ä–∞—Å–∏ –≥—Ä–∞–≤—Ü–µ–º
  - `toggle_ready_lobby` - –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ –≤ –ª–æ–±–±—ñ
  - `start_game_from_lobby` - –∑–∞–ø—É—Å–∫ –≥—Ä–∏ –∑ –ª–æ–±–±—ñ
  - `get_lobby_state` - –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å—Ç–∞–Ω—É –ª–æ–±–±—ñ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó
  - `leave_room` - –≤–∏—Ö—ñ–¥ –∑ –∫—ñ–º–Ω–∞—Ç–∏

### 3. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ—ó —á–∞—Å—Ç–∏–Ω–∏

- **gameManager.js** - –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –∑ –ª–æ–±–±—ñ –Ω–∞ —Å—Ç–∞—Ä—Ç—ñ –≥—Ä–∏
- **player.js** - –ø—Ä–∏–π–Ω—è—Ç—Ç—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
- **script.js** - –æ–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥—ñ–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—ñ–≤ –∫—ñ–º–Ω–∞—Ç

### 4. –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö

- –ù–æ–≤—ñ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü—ñ `game_rooms`:
  - `game_mode` - —Ä–µ–∂–∏–º –≥—Ä–∏ (classic/all_races)
  - `player1_race` - —Ä–∞—Å–∞ –≥—Ä–∞–≤—Ü—è 1
  - `player2_race` - —Ä–∞—Å–∞ –≥—Ä–∞–≤—Ü—è 2
  - `host_ready` - –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å —Ö–æ—Å—Ç–∞
  - `guest_ready` - –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –≥–æ—Å—Ç—è

## üöÄ –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –û–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

–í–∏–∫–æ–Ω–∞–π—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ë–î:

```bash
mysql -u your_username -p your_database < database_update_lobby.sql
```

–ê–±–æ –≤–∏–∫–æ–Ω–∞–π—Ç–µ –≤—Ä—É—á–Ω—É —á–µ—Ä–µ–∑ phpMyAdmin:

```sql
ALTER TABLE game_rooms
ADD COLUMN game_mode VARCHAR(20) NOT NULL DEFAULT 'all_races';

ALTER TABLE game_rooms
ADD COLUMN player1_race VARCHAR(50) NULL;

ALTER TABLE game_rooms
ADD COLUMN player2_race VARCHAR(50) NULL;

ALTER TABLE game_rooms
ADD COLUMN host_ready TINYINT(1) NOT NULL DEFAULT 0;

ALTER TABLE game_rooms
ADD COLUMN guest_ready TINYINT(1) NOT NULL DEFAULT 0;
```

### –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤—Å—ñ —Ñ–∞–π–ª–∏ –Ω–∞ –º—ñ—Å—Ü—ñ:

```
stratega/
‚îú‚îÄ‚îÄ lobby/
‚îÇ   ‚îú‚îÄ‚îÄ lobby.html
‚îÇ   ‚îú‚îÄ‚îÄ lobby.css
‚îÇ   ‚îî‚îÄ‚îÄ lobby.js
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îî‚îÄ‚îÄ room.php (–æ–Ω–æ–≤–ª–µ–Ω–æ)
‚îú‚îÄ‚îÄ game/
‚îÇ   ‚îú‚îÄ‚îÄ gameManager.js (–æ–Ω–æ–≤–ª–µ–Ω–æ)
‚îÇ   ‚îî‚îÄ‚îÄ player.js (–æ–Ω–æ–≤–ª–µ–Ω–æ)
‚îú‚îÄ‚îÄ script.js (–æ–Ω–æ–≤–ª–µ–Ω–æ)
‚îî‚îÄ‚îÄ database_update_lobby.sql (–Ω–æ–≤–∏–π)
```

### –ö—Ä–æ–∫ 3: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

1. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫—ñ–º–Ω–∞—Ç–∏:**

   - –ó–∞–π–¥—ñ—Ç—å –Ω–∞ –≥–æ–ª–æ–≤–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–º–Ω–∞—Ç—É"
   - –ó–∞–ø–æ–≤–Ω—ñ—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
   - –ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏ –ø–æ—Ç—Ä–∞–ø–∏—Ç–µ –≤ –ª–æ–±–±—ñ

2. **–ü—Ä–∏—î–¥–Ω–∞–Ω–Ω—è –¥–æ –∫—ñ–º–Ω–∞—Ç–∏:**

   - –Ü–Ω—à–∏–π –≥—Ä–∞–≤–µ—Ü—å –º–æ–∂–µ –ø—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –¥–æ –∫—ñ–º–Ω–∞—Ç–∏
   - –û–±–∏–¥–≤–∞ –≥—Ä–∞–≤—Ü—ñ –æ–ø–∏–Ω—è—Ç—å—Å—è –≤ –ª–æ–±–±—ñ

3. **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤ –ª–æ–±–±—ñ:**

   - –•–æ—Å—Ç –º–æ–∂–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –≤—Å—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
   - –ì—ñ—Å—Ç—å –±–∞—á–∏—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è, –∞–ª–µ –Ω–µ –º–æ–∂–µ —ó—Ö –∑–º—ñ–Ω—é–≤–∞—Ç–∏
   - –û–±–∏–¥–≤–∞ –≥—Ä–∞–≤—Ü—ñ –º–æ–∂—É—Ç—å –æ–±–∏—Ä–∞—Ç–∏ —Ä–∞—Å—É (—É –∫–ª–∞—Å–∏—á–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ)

4. **–ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å —Ç–∞ —Å—Ç–∞—Ä—Ç:**
   - –û–±–∏–¥–≤–∞ –≥—Ä–∞–≤—Ü—ñ –Ω–∞—Ç–∏—Å–∫–∞—é—Ç—å "–ì–æ—Ç–æ–≤–∏–π"
   - –•–æ—Å—Ç –º–æ–∂–µ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ "–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≥—Ä—É"
   - –ì—Ä–∞ —Å—Ç–∞—Ä—Ç—É—î –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏ –∑ –ª–æ–±–±—ñ

## üéÆ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –ª–æ–±–±—ñ

### –†–µ–∂–∏–º–∏ –≥—Ä–∏

1. **–í—Å—ñ —Ä–∞—Å–∏ (all_races)** - –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

   - –í—Å—ñ —é–Ω—ñ—Ç–∏ –≤—Å—ñ—Ö —Ä–∞—Å –¥–æ—Å—Ç—É–ø–Ω—ñ –æ–±–æ–º –≥—Ä–∞–≤—Ü—è–º
   - –í–∏–±—ñ—Ä —Ä–∞—Å–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π

2. **–ö–ª–∞—Å–∏—á–Ω–∏–π (classic)**
   - –ö–æ–∂–µ–Ω –≥—Ä–∞–≤–µ—Ü—å –æ–±–∏—Ä–∞—î 1 —Ä–∞—Å—É
   - –í –≥—Ä—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ —Ç—ñ–ª—å–∫–∏ —é–Ω—ñ—Ç–∏ –æ–±—Ä–∞–Ω–æ—ó —Ä–∞—Å–∏
   - –û–±–æ–≤'—è–∑–∫–æ–≤–∏–π –≤–∏–±—ñ—Ä —Ä–∞—Å–∏ –ø–µ—Ä–µ–¥ –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—é

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫—ñ–º–Ω–∞—Ç–∏ (—Ç—ñ–ª—å–∫–∏ —Ö–æ—Å—Ç)

- **–†–µ–∂–∏–º –≥—Ä–∏** - classic/all_races
- **–ß–∞—Å —Ä–∞—É–Ω–¥—É** - 30/45/60 —Å–µ–∫—É–Ω–¥
- **–°—Ç–∞—Ä—Ç–æ–≤—ñ –≥—Ä–æ—à—ñ** - 500/1000/1500/2000/3000
- **–î–æ—Ö—ñ–¥ –∑–∞ —Ä–∞—É–Ω–¥** - 0/100/200/300/500
- **–ú–∞–∫—Å–∏–º—É–º —é–Ω—ñ—Ç—ñ–≤** - 20-300 (—Å–ª–∞–π–¥–µ—Ä)

### –ü–∞–Ω–µ–ª—å –≥—Ä–∞–≤—Ü—ñ–≤

- –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω—ñ–∫–Ω–µ–π–º—ñ–≤ –æ–±–æ—Ö –≥—Ä–∞–≤—Ü—ñ–≤
- –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ (‚úÖ/‚è≥)
- –û–±—Ä–∞–Ω—ñ —Ä–∞—Å–∏ (—É –∫–ª–∞—Å–∏—á–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ)
- –í—ñ–∑—É–∞–ª—å–Ω–µ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –≥–æ—Ç–æ–≤–∏—Ö –≥—Ä–∞–≤—Ü—ñ–≤

### –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 2 —Å–µ–∫—É–Ω–¥–∏
- –ú–∏—Ç—Ç—î–≤–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –º—ñ–∂ –≥—Ä–∞–≤—Ü—è–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π redirect –≤ –≥—Ä—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤ –∫–æ–¥—ñ

### –ó–º—ñ–Ω–∞ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É polling (lobby.js)

```javascript
// –ó–º—ñ–Ω–∏—Ç–∏ —á–∞—Å—Ç–æ—Ç—É –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–∞ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 2000ms)
this.pollInterval = setInterval(async () => {
  await this.loadLobbyState();
}, 2000); // –ó–º—ñ–Ω—ñ—Ç—å –Ω–∞ –ø–æ—Ç—Ä—ñ–±–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è
```

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö —Ä–∞—Å (lobby.html)

```html
<div class="race-card" data-race="new_race">
  <div class="race-icon">üèõÔ∏è</div>
  <div class="race-name">New Race</div>
</div>
```

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

1. –î–æ–¥–∞–π—Ç–µ –ø–æ–ª–µ –≤ –ë–î
2. –û–Ω–æ–≤—ñ—Ç—å —Ñ–æ—Ä–º—É –≤ `lobby.html`
3. –î–æ–¥–∞–π—Ç–µ –æ–±—Ä–æ–±–∫—É –≤ `updateRoomSettings()` (`room.php`)
4. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –≤ `gameManager.js`

## üêõ –£—Å—É–Ω–µ–Ω–Ω—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ì—Ä–∞–≤—Ü—ñ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—é—Ç—å—Å—è

- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–æ–±–æ—Ç—É polling –≤ –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ session –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–∫—Ç–Ω–æ
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ `room.php`

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è

- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î
- –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ë–î

### –ì—Ä–∞ –Ω–µ —Å—Ç–∞—Ä—Ç—É—î

- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ –æ–±–∏–¥–≤–∞ –≥—Ä–∞–≤—Ü—ñ –≥–æ—Ç–æ–≤—ñ
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ `game_status` –∑–º—ñ–Ω—é—î—Ç—å—Å—è –Ω–∞ `in_progress`
- –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è Network tab –¥–ª—è –ø–æ–º–∏–ª–æ–∫ –∑–∞–ø–∏—Ç—ñ–≤

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏

- –í—Å—ñ –∑–º—ñ–Ω–∏ –∑–≤–æ—Ä–æ—Ç–Ω–æ —Å—É–º—ñ—Å–Ω—ñ –∑ —ñ—Å–Ω—É—é—á–æ—é —Å–∏—Å—Ç–µ–º–æ—é
- –°—Ç–∞—Ä—ñ –∫—ñ–º–Ω–∞—Ç–∏ –±—É–¥—É—Ç—å –º–∞—Ç–∏ `game_mode = 'all_races'` –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
- –ü—Ä–∏ –≤–∏—Ö–æ–¥—ñ —Ö–æ—Å—Ç–∞ –∫—ñ–º–Ω–∞—Ç–∞ –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è
- –ü—Ä–∏ –≤–∏—Ö–æ–¥—ñ –≥–æ—Å—Ç—è –≤—ñ–Ω –ø—Ä–æ—Å—Ç–æ –≤—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è

## üéØ –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

- [ ] –ß–∞—Ç –º—ñ–∂ –≥—Ä–∞–≤—Ü—è–º–∏ –≤ –ª–æ–±–±—ñ
- [ ] –Ü—Å—Ç–æ—Ä—ñ—è —ñ–≥–æ—Ä —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- [ ] –°–∏—Å—Ç–µ–º–∞ —Ä–∞–Ω–≥—ñ–≤ —Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥—É
- [ ] –°–ø–µ–∫—Ç–∞—Ç–æ—Ä—Å—å–∫–∏–π —Ä–µ–∂–∏–º
- [ ] –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–µ—Å–µ—Ç—ñ–≤ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
